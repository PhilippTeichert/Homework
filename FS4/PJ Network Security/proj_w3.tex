\documentclass[twoside]{article}

\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{fancyhdr}

\usepackage[margin=2.54cm]{geometry}

\usepackage{hyperref}

\newcommand{\say}[1]{%
	``#1''%
}
\newcommand{\ttt}[1]{%
	\texttt{#1}%
}


\begin{document}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[L]{Louis Kobras\\6658699}
\fancyhead[R]{Utz Pöhlmann\\6663579}
\fancyfoot[RE,LO]{Seite \thepage}

\begin{center}
\begin{Huge}
\textbf{SVS Bachelor-Projekt Network Security}
\end{Huge}\\\-\\
\begin{Large}
\textbf{Blatt 3: Datenkommunikation}
\end{Large}\\\-\\
\begin{minipage}[t]{0.48\textwidth}
\begin{center}\textbf{
	Louis Kobras\\
	6658699}
\end{center}
\end{minipage}
\begin{minipage}[t]{0.48\textwidth}
\begin{center}\textbf{
	Utz Pöhlmann\\
	6663579}
\end{center}
\end{minipage}
\end{center}

\section{HTTP}
\subsection{[local]}
Funktioniert so nicht, da die Website über das HTTPS-Protokoll läuft, welches SSL erfodert, welches wiederum nicht von telnet unterstützt wird.
Alternativ kann OpenSSL verwendet werden.\\
\\
Es konnte ein Stylesheet ausgelesen werden; (s. \cite{svscss}).\\
Kommentar: Zeilenumbrüche schaden nicht.


\section{SMPT (Mail Spoofing)}
\subsection{[local]}
\begin{itemize}
	\item Verbinden zum Mailserver mit \ttt{telnet mailhost.informatik.uni-hamburg.de 25} (25 ist der Port des Servers)
	\item Eingabe folgender Befehle:
	\begin{itemize}
		\item \ttt{EHLO svs-labwall.informatik.uni-hamburg.de}
		\item \ttt{MAIL FROM: <svsg07@informatik.uni-hamburg.de>}
		\item \ttt{RCPT TO: <4kobras@informatik.uni-hamburg.de>}
		\item \ttt{DATA}
	\end{itemize}
	\item folgender Mail-Text: \ttt{``Hier könnte Ihr Inhalt stehen''}
	\item Quelltextvergleich mit ``echter'' Mail ergab fehlende Konfigurationsinformationen
	\item Mangel nicht offensichtlich, kann durch Ergänzung der obigen Eingabe zwischen \ttt{DATA} und dem Mail-Text angepasst werden
	\item Fehlende Informationen:
	\begin{itemize}
		\item \ttt{MIME-Version: 1.0}
		\item \ttt{Content-Type: text/plain;\\
				\-~~~~~~~~charset=ISO-8895-1;\\
				\-~~~~~~~~DelSp="Yes";\\
				\-~~~~~~~~format="flowed"}
		\item \ttt{Content-Disposition: inline}
		\item \ttt{Content-Transfer-Encoding: 7bit}
		\item \ttt{User-Agent: Internet Messaging Program (IMP) H3 (4.1.5)}
	\end{itemize}
	\item Absender \ttt{gmail.com} ebenfalls möglich; folgender Eintrag ist zu modifizieren:
	\begin{itemize}
		\item \ttt{EHLO google.com}
	\end{itemize}
	\item Fehlerfall: Shell terminiert \ttt{telnet}-Ausführung mit dem Kommentar \ttt{``I can break rules, too. Goodbye.''}
\end{itemize}



\section{License Server (DNS-Spoofing)}
\subsection{[local]}
Protokoll:
\begin{enumerate}
	\item Key als User-Input
	\item Übermitteln des Keys an den Server
	\item Rückgabe vom Server, ob Key gültig oder nicht (\ttt{SERIAL\textunderscore VALID=0} bzw. \ttt{SERIAL\textunderscore VALID=1})
	\item[4a] Wenn gültig, Dank für Kauf
	\item[4b] Wenn nicht gültig, FBI ist unterwegs
\end{enumerate}
\subsection{}
\begin{itemize}
	\item Verhindern der Kommunikation der Software mit dem echten Auth-Server
	\item Geschehen durch Erweitern des Hosts um \ttt{127.0.0.1    license-server.svslab} in \ttt{/etc/hosts}
	\item Herunterladen der Java-Klasse \ttt{TCPClient.java} (\cite{javatcp})
	\item Manipulieren des Servers: \ttt{ServerSocket} auf svslab-Port (1337) gesetzt
	\item Manipulieren des Servers: Rückgabe des Servers auf statisch \ttt{\say{SERIAL\textunderscore VALID=1}} gesetzt
	\item $\Longrightarrow$ alle Keys gültig, unabhängig von Eingabe
\end{itemize} 
\subsection{}
Es gibt zwei anmerkbare Mängel.
\begin{enumerate}
	\item Es sollte nicht angegeben werden, ob die Serial-Länge korrekt ist.
	\item Es könnte mithilfe einer eindeutigen Signatur o.Ä. eine Abfrage an den Server eingebunden werden, ob er \say{echt} ist (gehasht).
\end{enumerate}


\section{License Server (Brute-Force-Angriff)}
\subsection{[local]}
Das Programm funktioniert an sich, wenn man aber an den Server sendet, kriegt man (scheinbar nach Zufall) entweder \say{invalid command} oder \say{invalid length} zurück, bei Eingabe von \ttt{serial=abcdefgh} ($a,b,c,d,e,f,g,h \in \{0,1,...,9\}$).

Wir baten zwei Gruppen neben uns um Hilfe, jedoch konnten diese uns auch nicht weiterhelfen bzw. haben keinen Fehler in unserem Programm gefunden.

Als Ausgangspunkt wurde die Java-Klasse \ttt{TCPClient.java} (source: \cite{javatcp}) genommen.

Einige gültige Keys:\\
\begin{center}
\begin{minipage}[t]{0.23\textwidth}
	\begin{itemize}
		\item 03133700
		\item 06264700
		\item 09401100
		\item 15668500
	\end{itemize}
\end{minipage}
\begin{minipage}[t]{0.23\textwidth}
	\begin{itemize}
		\item 18802200
		\item 21935900
		\item 25069600
		\item 31337000
	\end{itemize}
\end{minipage}
\begin{minipage}[t]{0.23\textwidth}
	\begin{itemize}
		\item 47005500
		\item 59540300
		\item 62674000
		\item 72075100
	\end{itemize}
\end{minipage}
\begin{minipage}[t]{0.23\textwidth}
	\begin{itemize}
		\item 87743600
		\item 90877300
		\item 94011000
		\item 97144700
	\end{itemize}
\end{minipage}
\end{center}

\subsection{}
Möglichkeiten, sich zu verteidigen, enthalten, sind jedoch nicht beschränkt auf:
\begin{itemize}
	\item Sperren des Absenders der Auth-Anfrage nach $n$ Fehlversuchen (Unterbrechen von Brute-Force-Attacken)\footnote{Je nach Art der Sperrung ist dies lediglich eine Bremse; wird z.B. nur die IP gesperrt, kann diese resettet werden, um wieder Zugang zu erlangen.}
	\item Prüfung der IP bzw. Prüfsumme, ob Empfänger und Absender korrekt sind (Zurechenbarkeit)
	\item Limitieren der Eingabe auf $k$ pro Minute (Verlangsamen von Brute-Force-Attacken)
\end{itemize}
\subsection{[local]}
Alle gefundenen gültigen Schlüssel sind durch 100 teilbar, liegen also in der Form $xxxxxx00$ vor.
Ist ein Schlüssel außderdem durch 1000 teilbar, also in der Form $xxxxx000$, so ist ebenso ein Schlüssel der Form $0xxxxx00$ gültig, der die gleiche Ziffernfolge anstelle der $x$ enthält.


\section{Implementieren eines TCP-Chats}
\subsection{[local]}
Es werden zwei URLs in Fragmenten gesendet.
Zusammengesetzt sehen sie folgendermaßen aus:
\begin{itemize}
	\item $[$URL1$]$ \texttt{http://www.oracle.com/technetwork/java/socket-140484.html}
	\item $[$URL2$]$ \texttt{http://code.google.com/p/example-of-servlet/source/browse/trunk/}\\\texttt{src/javaLanguage/basic/?r=56\#basic\%2Fsocket}
\end{itemize}
\subsection{}
\subsection{}
\subsection{}
\subsection{}

\begin{thebibliography}{1}
\bibitem{svscss}	\url{https://www.inf.uni-hamburg.de/assets/application-11e3b49e605\\ff8ba1f01d275bd36850edfdfc1fbbb8c22e55fae1baf643a00d0.css}
\bibitem{javatcp}	\url{https://systembash.com/a-simple-java-tcp-server-and-tcp-client/}
\end{thebibliography}
\end{document}